<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>互動式年表：新約聖經的歷史脈絡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Parchment & Gold -->
    <!-- Application Structure Plan: The SPA is designed around a central, interactive timeline, which is the core navigation element. The layout is divided into: 1. A header with an introduction. 2. A main timeline visualization (using Chart.js) that allows users to see the chronological flow of events and writings. 3. Below the timeline, a detailed information section that updates dynamically as the user interacts with the timeline or a period selector. 4. Thematic deep-dive sections ('關鍵派系', '正典形成') accessible via buttons, which replace the timeline view to focus on specific concepts. This structure was chosen because the source report is fundamentally chronological. An interactive timeline provides the most intuitive way for users to grasp the temporal relationships between political events, religious developments, and textual composition. Thematic deep-dives allow for exploring cross-cutting concepts without cluttering the main timeline. -->
    <!-- Visualization & Content Choices:
        - Report Info: Comprehensive timeline of events & writings -> Goal: Organize/Change -> Viz: Timeline Chart (Chart.js scatter plot with line) -> Interaction: Hover/Click on points to display detailed information below the chart -> Justification: Visually represents the flow of history and the temporal placement of key events and texts, which is the central theme of the report. This is far more engaging than a static HTML table.
        - Report Info: Details of historical periods (e.g., '第二聖殿時期') -> Goal: Inform -> Viz: Styled HTML text blocks with Tailwind CSS -> Interaction: Content updates based on timeline interaction or button clicks -> Justification: Presents detailed textual information in a clean, readable format. Dynamic updates keep the interface focused.
        - Report Info: Jewish factions (Pharisees, Sadducees, etc.) -> Goal: Compare/Organize -> Viz: Tabbed interface with styled cards (HTML/CSS/JS) -> Interaction: Click tabs to switch between descriptions of each faction -> Justification: Allows for easy comparison of the different groups' beliefs and roles side-by-side.
        - Report Info: Canonization process -> Goal: Organize/Change -> Viz: Vertical timeline diagram built with HTML/Tailwind -> Interaction: Hover effects to highlight stages -> Justification: Clearly illustrates the step-by-step process of canon formation over several centuries.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #F8F5F0;
            color: #4A4A4A;
        }
        .nav-button {
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        .nav-button.active {
            border-bottom-color: #C0A062;
            color: #3D352A;
        }
        .content-section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        .content-section.active {
            display: block;
        }
        .timeline-point:hover {
            transform: scale(1.1);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .chart-container {
            position: relative;
            width: 100%;
            height: 350px;
            max-height: 400px;
            background-color: #FFFFFF;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
        }
        .tab-button.active {
            background-color: #C0A062;
            color: white;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .gemini-button {
            transition: all 0.3s ease;
        }
        .gemini-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(192, 160, 98, 0.3);
        }
        .loader {
            width: 24px;
            height: 24px;
            border: 3px solid #C0A062;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto px-4 py-8">
        
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-[#3D352A] mb-2">從宗派到正典：新約世界的編年史</h1>
            <p class="text-lg text-gray-600">一份探索新約聖經歷史脈絡的互動指南</p>
        </header>

        <nav class="flex justify-center gap-6 md:gap-8 mb-10 border-b border-gray-200">
            <button data-target="timeline-view" class="nav-button active text-lg font-semibold pb-2">歷史時間軸</button>
            <button data-target="factions-view" class="nav-button text-lg font-semibold pb-2">關鍵派系</button>
            <button data-target="canon-view" class="nav-button text-lg font-semibold pb-2">正典形成</button>
        </nav>
        
        <main id="main-content">

            <!-- Timeline View -->
            <section id="timeline-view" class="content-section active">
                <div class="text-center max-w-3xl mx-auto mb-8">
                    <h2 class="text-3xl font-bold text-[#3D352A] mb-4">互動歷史年表</h2>
                    <p class="text-md text-gray-700">此互動年表展示了從馬加比革命到新約正典確立的關鍵事件。將滑鼠懸停或點擊圖表上的事件點，即可在下方查看該事件的詳細資訊。透過視覺化的方式，您可以清晰地看到政治背景、宗教事件與新約寫作之間的時間關係。</p>
                </div>

                <div class="chart-container mb-8">
                    <canvas id="timelineChart"></canvas>
                </div>

                <div id="timeline-detail" class="bg-white p-6 rounded-lg shadow-md min-h-[200px] transition-all duration-300">
                    <h3 id="detail-title" class="text-2xl font-bold text-[#C0A062] mb-3">歡迎</h3>
                    <p id="detail-text" class="text-gray-800">請在上方圖表中選擇一個事件點以查看詳細資訊。</p>
                    <p id="detail-date" class="text-sm text-gray-500 mt-4"></p>
                    <div id="gemini-container" class="mt-6">
                        <button id="gemini-button" class="gemini-button hidden bg-[#C0A062] text-white font-bold py-2 px-4 rounded-lg shadow-md">✨ 深入探索此事件</button>
                        <div id="gemini-loader" class="hidden mt-4 flex items-center gap-3">
                            <div class="loader"></div>
                            <span class="text-gray-600">正在生成更深入的解析...</span>
                        </div>
                        <div id="gemini-response" class="mt-4 text-gray-800 border-t pt-4 border-gray-200"></div>
                    </div>
                </div>
            </section>
            
            <!-- Factions View -->
            <section id="factions-view" class="content-section">
                <div class="text-center max-w-3xl mx-auto mb-12">
                    <h2 class="text-3xl font-bold text-[#3D352A] mb-4">猶太社會與宗教版圖</h2>
                    <p class="text-md text-gray-700">新約時代的猶太教並非鐵板一塊，而是由多個思想和實踐各異的派系構成。這些派系對律法、聖殿及羅馬統治有著不同看法，共同塑造了耶穌事工的社會背景。點擊下方的標籤，探索各個主要派系的核心信仰與特徵。</p>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <div class="flex flex-wrap justify-center border-b border-gray-200 mb-4">
                        <button data-tab="pharisees" class="tab-button py-2 px-6 font-medium text-gray-600 rounded-t-lg">法利賽人</button>
                        <button data-tab="sadducees" class="tab-button py-2 px-6 font-medium text-gray-600 rounded-t-lg">撒都該人</button>
                        <button data-tab="essenes" class="tab-button py-2 px-6 font-medium text-gray-600 rounded-t-lg">愛色尼派</button>
                        <button data-tab="zealots" class="tab-button py-2 px-6 font-medium text-gray-600 rounded-t-lg">奮銳黨</button>
                    </div>
                    <div id="factions-content" class="p-4">
                        <!-- Content will be injected here by JS -->
                    </div>
                </div>
            </section>

            <!-- Canonization View -->
            <section id="canon-view" class="content-section">
                <div class="text-center max-w-3xl mx-auto mb-12">
                    <h2 class="text-3xl font-bold text-[#3D352A] mb-4">新約正典的形成</h2>
                    <p class="text-md text-gray-700">新約正典並非一蹴可幾，而是教會在數百年間，面對內外挑戰，逐漸辨識、確認而形成的一系列權威文獻。此過程反映了教會從一個運動演變為一個制度化世界宗教的關鍵歷程。下方以垂直時間軸呈現此過程中的重要里程碑。</p>
                </div>

                <div class="relative pl-8 border-l-2 border-[#C0A062]">
                    <!-- Canon items will be injected here by JS -->
                </div>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            const timelineData = [
                { year: -167, event: '馬加比革命', type: '宗教事件', details: '面對塞琉古王朝的強制希臘化政策，猶太馬加比家族領導了一場成功的起義，恢復了宗教自由並建立了哈斯蒙尼王朝。' },
                { year: -63, event: '龐培征服耶路撒冷', type: '政治背景', details: '羅馬將軍龐培利用哈斯蒙尼王朝內鬥，率軍征服耶路撒冷，結束了猶太人的獨立時代，猶太地從此成為羅馬勢力範圍。' },
                { year: -40, event: '大希律王被封', type: '政治背景', details: '以土買人希律被羅馬元老院封為「猶太人之王」。他的統治充滿了宏偉的建築工程（如擴建第二聖殿）與血腥的政治清算。' },
                { year: -5, event: '耶穌誕生', type: '宗教事件', details: '耶穌誕生於伯利恆。根據《馬太福音》和《路加福音》的記載，並結合大希律王於公元前4年去世的史實，學術界普遍將耶穌的誕生年份定於公元前6至4年之間。' },
                { year: 29, event: '耶穌開始事工', type: '宗教事件', details: '根據《路加福音》，在提庇留皇帝在位第15年，施洗約翰開始傳道，耶穌受洗並展開事工，時年約三十歲。' },
                { year: 33, event: '耶穌被釘十字架', type: '宗教事件', details: '在本丟·彼拉多任猶太巡撫期間，耶穌在耶路撒冷逾越節時被釘十字架。這是基督教信仰的核心事件。' },
                { year: 33.1, event: '五旬節事件', type: '宗教事件', details: '聖靈降臨在門徒身上，彼得講道，約三千人歸信，耶路撒冷教會誕生。這被視為基督教會的誕生日。' },
                { year: 35, event: '保羅歸信', type: '宗教事件', details: '原為教會迫害者的法利賽人掃羅（保羅），在前往大馬士革的路上遇見復活的耶穌，從而轉變為基督教最偉大的使徒之一。' },
                { year: 48, event: '《加拉太書》寫作', type: '著作寫作', details: '很可能在耶路撒冷會議前後寫成，是保羅對「猶太派信徒」最有力的回擊，捍衛「因信稱義」的福音。' },
                { year: 49, event: '耶路撒冷會議', type: '宗教事件', details: '為解決外邦信徒是否需行割禮的爭議而召開。會議決議外邦信徒無需遵守猶太儀式律法，為基督教成為世界性信仰掃清了障礙。' },
                { year: 51, event: '《帖撒羅尼迦前後書》寫作', type: '著作寫作', details: '保羅現存最早的書信，寫於第二次傳道旅程中，為了解決帖撒羅尼迦教會對基督再來的困惑。' },
                { year: 55, event: '《哥林多前後書》與《羅馬書》寫作', type: '著作寫作', details: '寫於保羅第三次傳道旅程中。《羅馬書》是保羅對其福音思想最系統的闡述。' },
                { year: 62, event: '監獄書信寫作', type: '著作寫作', details: '保羅在羅馬第一次被囚期間，寫下了《以弗所書》、《腓立比書》、《歌羅西書》和《腓利門書》。' },
                { year: 64, event: '尼祿迫害基督徒', type: '政治背景', details: '羅馬城大火後，尼祿皇帝為轉移焦點而將罪責歸於基督徒，引發了首次大規模迫害。傳統認為彼得與保羅在此期間殉道。' },
                { year: 70, event: '耶路撒冷與聖殿被毀', type: '政治背景', details: '羅馬將軍提圖斯在平定第一次猶太-羅馬戰爭時，摧毀了耶路撒冷及第二聖殿。此事件極大加速了基督教與猶太教的分離。' },
                { year: 70.1, event: '《馬可福音》寫作', type: '著作寫作', details: '通常被認為是四福音書中最早的一卷，可能為應對尼祿迫害和猶太戰爭的危機而寫，強調耶穌是受苦的彌賽亞。' },
                { year: 85, event: '《馬太福音》與《路加福音》寫作', type: '著作寫作', details: '這兩卷福音書參考了《馬可福音》和Q來源。《馬太福音》面向猶太基督徒，《路加福音-使徒行傳》則面向外邦讀者。' },
                { year: 95, event: '《啟示錄》寫作', type: '著作寫作', details: '在圖密善皇帝推行皇帝崇拜引發迫害的背景下，使徒約翰在拔摩島寫下《啟示錄》，以天啟文學體裁鼓勵受苦的教會。' },
                { year: 98, event: '《約翰福音》寫作', type: '著作寫作', details: '最後寫成的福音書，反映了數十年的深度神學反思，以極高的基督論著稱，顯示出與猶太會堂的徹底決裂。' },
                { year: 135, event: '巴爾·科赫巴起義失敗', type: '政治背景', details: '猶太基督徒因不承認起義領袖為彌賽亞而拒絕參與，導致與猶太教的徹底決裂。' },
                { year: 140, event: '馬吉安編制異端正典', type: '正典形成', details: '馬吉安編制了一個只包含刪改版《路加福音》和十封保羅書信的「正典」，刺激了主流教會界定自身的經典範圍。' },
                { year: 170, event: '《穆拉多利殘篇》問世', type: '正典形成', details: '現存最古老的主流教會正典書目，其列出的書卷已與現代新約極為接近，顯示核心正典在二世紀末已形成。' },
                { year: 367, event: '亞他那修的復活節信函', type: '正典形成', details: '亞歷山大主教亞他那修在其第39封復活節信函中，首次完整列出今日的27卷新約正典，一錘定音。' },
                { year: 397, event: '迦太基會議', type: '正典形成', details: '繼希波會議後，迦太基會議在西方教會正式確認了亞他那修提出的27卷新約正典的權威地位，標誌著正典化進程的完成。' },
            ];
            
            const factionsData = {
                pharisees: {
                    title: "法利賽人 (Pharisees)",
                    content: "他們是當時在民間最具影響力的宗教派系。他們不僅尊崇成文的摩西律法（妥拉），也同樣重視「口傳律法」。在神學上，他們相信靈魂不滅、身體復活、天使與鬼魔的存在。他們的影響力主要體現在各地的猶太會堂。"
                },
                sadducees: {
                    title: "撒都該人 (Sadducees)",
                    content: "主要由耶路撒冷的祭司貴族和富裕階層組成，是聖殿的領導核心。在政治上傾向與羅馬合作。在神學上，他們只接受成文的摩西五經為權威，拒絕承認口傳律法，並且不相信復活、天使或靈魂不滅。公元70年聖殿被毀後，他們也隨之消失。"
                },
                essenes: {
                    title: "愛色尼派 (Essenes)",
                    content: "一個苦修和分離主義的群體，他們認為耶路撒冷聖殿已被腐敗的祭司所玷污，因此退隱到曠野過著嚴格的社群生活。許多學者認為發現《死海古卷》的庫姆蘭社團即為其分支。他們抱持末世論世界觀，等待著與「黑暗之子」的終極大戰。"
                },
                zealots: {
                    title: "奮銳黨 (Zealots)",
                    content: "激進的革命組織，堅信唯有透過武力革命推翻羅馬統治，才能恢復上帝在以色列的神權統治。他們不惜採取暗殺和恐怖襲擊等手段，是引發公元66年第一次猶太-羅馬戰爭的重要因素。"
                }
            };
            
            const canonData = [
                { year: 'c. 140 CE', title: '馬吉安的挑戰', text: '富裕船主馬吉安編制了第一個「新約正典」，但其內容基於他的異端神學。此舉刺激了主流教會必須界定自己的權威文本。' },
                { year: 'c. 170 CE', title: '穆拉多利殘篇', text: '一份現存最古老的正典書目，列出了被教會公認的核心新約書卷，包括四福音書、使徒行傳、保羅的十三封書信等，顯示核心正典已初步形成。' },
                { year: 'c. 325 CE', title: '優西比烏的分類', text: '教會歷史學家優西比烏將當時的基督教著作分為「公認的」、「有爭議的」和「偽託的」三類，顯示正典輪廓已非常清晰。' },
                { year: '367 CE', title: '亞他那修的信函', text: '亞歷山大主教亞他那修在其第39封復活節信函中，歷史上首次完整列出了與今日完全相同的27卷新約正典書目。' },
                { year: '393/397 CE', title: '教會會議的確認', text: '希波會議 (393 CE) 與迦太基會議 (397 CE) 在西方教會正式「承認」並「確認」了這27卷新約正典的權威地位，標誌著正典化過程的基本完成。' }
            ];

            let timelineChartInstance;
            let currentDataPoint = null;
            
            const pointColors = {
                '政治背景': 'rgba(100, 100, 100, 0.9)',
                '宗教事件': 'rgba(192, 160, 98, 0.9)',
                '著作寫作': 'rgba(61, 53, 42, 0.9)',
                '正典形成': 'rgba(128, 0, 0, 0.9)'
            };

            const createTimelineChart = () => {
                const ctx = document.getElementById('timelineChart').getContext('2d');
                
                const sortedData = [...timelineData].sort((a, b) => a.year - b.year);
                const yLevels = [0, 0.6, -0.6, 1.2, -1.2];
                let lastYear = -Infinity;
                let yLevelIndex = 0;

                const processedData = sortedData.map(d => {
                    if (Math.abs(d.year - lastYear) < 5) {
                        yLevelIndex = (yLevelIndex + 1) % yLevels.length;
                    } else {
                        yLevelIndex = 0;
                    }
                    lastYear = d.year;
                    return { ...d, y: yLevels[yLevelIndex] };
                });

                const datasets = Object.keys(pointColors).map(type => ({
                    label: type,
                    data: processedData.filter(d => d.type === type).map(d => ({ x: d.year, y: d.y, data: d })),
                    backgroundColor: pointColors[type],
                    borderColor: 'rgba(0,0,0,0)',
                    pointRadius: 8,
                    pointHoverRadius: 12,
                }));

                if (timelineChartInstance) {
                    timelineChartInstance.destroy();
                }

                timelineChartInstance = new Chart(ctx, {
                    type: 'scatter',
                    data: { datasets },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                type: 'linear',
                                position: 'bottom',
                                min: -180,
                                max: 410,
                                title: {
                                    display: true,
                                    text: '年份 (BCE/CE)',
                                    font: { size: 14 }
                                }
                            },
                            y: {
                                display: false,
                                min: -2,
                                max: 2
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    usePointStyle: true,
                                    font: { size: 12 },
                                    padding: 20
                                }
                            },
                            tooltip: {
                                enabled: true,
                                callbacks: {
                                    label: function(context) {
                                        return ` ${context.raw.data.event}`;
                                    }
                                }
                            }
                        },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const dataPoint = elements[0].element.$context.raw.data;
                                updateDetailView(dataPoint);
                            }
                        },
                        onHover: (event, chartElement) => {
                            event.native.target.style.cursor = chartElement[0] ? 'pointer' : 'default';
                        }
                    }
                });
            };

            const updateDetailView = (dataPoint) => {
                currentDataPoint = dataPoint;
                document.getElementById('detail-title').textContent = dataPoint.event;
                document.getElementById('detail-text').textContent = dataPoint.details;
                let yearText = dataPoint.year < 0 ? `約 公元前 ${-dataPoint.year} 年` : `約 公元 ${Math.floor(dataPoint.year)} 年`;
                if (!dataPoint.year) yearText = '';
                document.getElementById('detail-date').textContent = yearText;

                const geminiButton = document.getElementById('gemini-button');
                const geminiResponse = document.getElementById('gemini-response');
                const geminiLoader = document.getElementById('gemini-loader');

                geminiResponse.innerHTML = '';
                geminiLoader.classList.add('hidden');
                
                if (dataPoint.event && dataPoint.event !== '歡迎') {
                    geminiButton.classList.remove('hidden');
                } else {
                    geminiButton.classList.add('hidden');
                }
            };
            
            async function fetchGeminiExplanation() {
                if (!currentDataPoint) return;

                const geminiButton = document.getElementById('gemini-button');
                const geminiLoader = document.getElementById('gemini-loader');
                const geminiResponse = document.getElementById('gemini-response');

                geminiButton.classList.add('hidden');
                geminiLoader.classList.remove('hidden');
                geminiResponse.innerHTML = '';

                const prompt = `在基督新教的歷史神學觀點下，並處於新約聖經的歷史脈絡中，請針對以下歷史事件提供更深入的解析：「${currentDataPoint.event}」。請用2-3個段落解釋其歷史與宗教意義，以及它對早期基督教發展的影響。請使用繁體中文回答。`;

                const apiUrl = `/.netlify/functions/gemini`;
                
                try {
                    const response = await fetch(apiUrl, {
						method: 'POST',
						headers: { 'Content-Type': 'application/json' },
						// 將 prompt 作為 JSON 的一部分發送給您的函式
						body: JSON.stringify({ prompt: prompt }) 
                    });

                    if (!response.ok) {
                        throw new Error(`API 請求失敗，狀態碼：${response.status}`);
                    }

                    const result = await response.json();
                    
                    if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts && result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        geminiResponse.innerHTML = text.replace(/\n/g, '<br>');
                    } else {
                        throw new Error('從API收到的回應格式無效。');
                    }

                } catch (error) {
                    console.error('Gemini API Error:', error);
                    geminiResponse.innerHTML = `<p class="text-red-600">抱歉，無法生成解析。請稍後再試。</p>`;
                } finally {
                    geminiLoader.classList.add('hidden');
                }
            }

            const setupNavigation = () => {
                const navButtons = document.querySelectorAll('.nav-button');
                const contentSections = document.querySelectorAll('.content-section');
                
                navButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const targetId = button.dataset.target;
                        
                        navButtons.forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');
                        
                        contentSections.forEach(section => {
                            section.classList.remove('active');
                            if (section.id === targetId) {
                                section.classList.add('active');
                            }
                        });

                        if(targetId === 'timeline-view') {
                            createTimelineChart();
                            updateDetailView({event: '歡迎', details: '請在上方圖表中選擇一個事件點以查看詳細資訊。', year: ''});
                        }
                        if(targetId === 'factions-view') {
                            setupFactionsTabs();
                        }
                         if(targetId === 'canon-view') {
                            renderCanonTimeline();
                        }
                    });
                });
            };

            const setupFactionsTabs = () => {
                const tabButtons = document.querySelectorAll('#factions-view .tab-button');
                const contentContainer = document.getElementById('factions-content');

                function renderTabContent(tabId) {
                     const data = factionsData[tabId];
                    contentContainer.innerHTML = `
                        <div class="tab-content active">
                            <h3 class="text-2xl font-bold text-[#C0A062] mb-3">${data.title}</h3>
                            <p class="text-gray-800 leading-relaxed">${data.content}</p>
                        </div>
                    `;
                    tabButtons.forEach(btn => {
                        btn.classList.remove('active');
                        if (btn.dataset.tab === tabId) {
                            btn.classList.add('active');
                        }
                    });
                }
                
                tabButtons.forEach(button => {
                    button.addEventListener('click', () => {
                       renderTabContent(button.dataset.tab);
                    });
                });
                
                renderTabContent('pharisees');
            };
            
            const renderCanonTimeline = () => {
                const container = document.querySelector('#canon-view .relative');
                container.innerHTML = canonData.map(item => `
                    <div class="mb-8">
                        <div class="flex items-center mb-1">
                            <div class="bg-[#C0A062] z-10 w-4 h-4 rounded-full -ml-[9px] border-2 border-white"></div>
                            <p class="ml-4 font-bold text-lg text-gray-700">${item.year}</p>
                        </div>
                        <div class="ml-8">
                            <h4 class="font-semibold text-xl text-[#3D352A]">${item.title}</h4>
                            <p class="mt-1 text-gray-600">${item.text}</p>
                        </div>
                    </div>
                `).join('');
            };

            // Initial setup
            document.getElementById('gemini-button').addEventListener('click', fetchGeminiExplanation);
            setupNavigation();
            createTimelineChart();
            updateDetailView({event: '歡迎', details: '請在上方圖表選擇一個事件點以查看詳細資訊。', year: ''});
        });
    </script>
</body>
</html>
